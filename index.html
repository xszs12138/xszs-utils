<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <button id="exportExcelButton">导出Excel</button>
  <script type="module">
    import { exportExcel } from './src/utils/index.js'
    const exportExcelButton = document.getElementById('exportExcelButton')
    exportExcelButton.addEventListener('click', handleExportExcel)
    async function handleExportExcel() {

         exportExcel([
          {
            data: [
              { infoDate: '2025-12-01dskajhdgasjhgdjshagdhjsagdhjadgjasg', infoTime: '08:00', student: 1200, teacher: 450, realTimePrice: 465 },
              { infoDate: '2025-12-01', infoTime: '09:00', student: 1350, teacher: 458, realTimePrice: 472 },
              { infoDate: '2025-12-02', infoTime: '08:00', student: 1180, teacher: 445, realTimePrice: 458 },
            ],
            tableHeader: [
              { header: '日期', key: 'infoDate' },
              { header: '时段', key: 'infoTime' },
              { header: '学生数', key: 'student' },
              { header: '老师数', key: 'teacher' },
              { header: '电价', key: 'realTimePrice' },
            ],
            sheetName: '表单1',
            plugins: [{ name: 'autoMergeCell' }, { name: 'autoBestWidth', options: { maxThreshold: 100 } }],
          },
          {
            data: [
              { infoDate: '2025-12-02', infoTime: '08:00', student: 50, teacher: 120, realTimePrice: { a: 1, b: 2 } },
              { infoDate: '2025-12-02', infoTime: '09:00', student: 100, teacher: undefined, realTimePrice: 472 },
              { infoDate: '2025-12-04', infoTime: '08:00', student: 20, teacher: [123123], realTimePrice: 458 },
            ],
            tableHeader: [
              { header: '日期', key: 'infoDate' },
              { header: '时段', key: 'infoTime' },
              { header: '学生数', key: 'student' },
              { header: '老师数', key: 'teacher' },
              { header: '电价', key: 'realTimePrice' },
            ],
            sheetName: '表单2',
            plugins: [{ name: 'autoBestWidth', options: { maxThreshold: 100 } }, { name: 'excelMartNumber', options: { martMaxNumber: 400, markFontOptions: { color: { argb: 'FFFF0000' } } } }],
          },
        ], '测试文件', (cell) => {
          cell.alignment = { horizontal: 'center', vertical: 'middle' }
        }).then(() => {
          console.log('导出成功')
        })
    }

  </script>
</body>

</html>
